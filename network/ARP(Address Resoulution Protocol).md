# ARP(Address Resolution Protocol)

`ARP`는 **논리적인 주소(IP)를 물리적인 주소(MAC)으로 바꿔주는 작업**입니다. 통신할 단말이 물리 주소를 필요로 할 때 사용됩니다. 

## ARP는 왜 필요할까요?

PC가 **네트워크를 통해 메시지를 보내려면 OSI 모델을 따라서 Encapsulation이 필요**합니다.

즉, 4계층 헤더의 TCP/UDP 포트, 3계층에서 출발, 도착지의 IP 주소, 2계층 헤더의 출발, 도착지의 MAC 주소와 같은 헤더 정보를 모두 채워야 합니다. 

생각을해보면 **목적지의 MAC 주소를 제외하고는 클라이언트에서 채워 넣을 수 있습니다.** 그래서 **목적지 MAC 주소를 채우기 위해 먼저 보내는 것이 `ARP Request`**입니다.

ARP 요청을 통해 MAC 주소를 알아낸 후 헤더 정보를 모두 채워서 메시지를 보냅니다.

## ARP 과정
**1. ARP 요청**
<br>: 송신자는 (출발지(자신) MAC 주소 + 출발지 IP + 목적지 IP)의 정보로 Broadcast Domain에 포함된 PC들에게 **`Broadcast`**시킵니다.

**2. ARP Reply**
<br>: 요청을 수신한 PC들은 목적지 IP주소를 확인하고 자신이 아니라면 삭제하고, 자신이 맞다면 자신의 MAC 주소를 포함시켜서 응답을 보냅니다. 이때 **`Unicast` 방식으로 전송**합니다. 

## ARP가 사용되는 경우 4가지**

<img src="https://user-images.githubusercontent.com/53790137/151483305-ce576644-ba37-45fb-8cc8-56f341ebc2d9.png" width="500" height="400">

## ARP Cache Table
통신할 단말끼리 **매번 ARP를 사용하는 것은 매우 비효율적**이기 때문에 스위치나 라우터와 같은 통신 장비는 **IP 주소와 매핑되는 MAC 주소를 메모리에 캐싱**하여 사용합니다.

## 마무리

> **IP 주소의 통신은 사실 각 라우터 hop 에서 일어나는 MAC 주소와 MAC 주소 통신의 연속적인 과정이다.**

ARP를 이해한다면 위의 말을 이해할 수 있게 됩니다.
