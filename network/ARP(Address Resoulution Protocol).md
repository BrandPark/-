# ARP(Address Resolution Protocol)

`ARP`는 **논리적인 주소(IP)를 물리적인 주소(MAC)으로 바꿔주는 작업**입니다. 통신할 단말이 물리 주소를 필요로 할 때 사용됩니다. 

## ARP는 왜 필요할까요?

IP를 통해 라우팅하여 LAN에 접근까지는 했다고 가정해 보겠습니다. LAN 내에서 단말간 통신을 하기 위해서는 데이터 링크 계층을 이용합니다.

그런데 데이터 링크 계층은 프레임에 목적지 MAC 주소가 없다면 오류 프레임으로 간주하여 폐기 처분하기 때문에 **MAC 주소가 반드시 있어야 합니다.**

> 그런데, 통신할 때 목적지의 MAC주소를 어떻게 알고 넣을까요?

먼저 데이터를 보내는 송신자는 2계층 헤더의 목적지 MAC 주소를 알 수 없기 때문에 비우고 목적지 IP 주소만 넣어서 보냅니다.

그렇게 IP 주소를 통해 LAN에 접근한 다음 **2계층에 보내기 전에 ARP 요청을 통해 MAC주소를 알아낸 후 추가시켜서 보냅니다.** 

## ARP 과정
**1. ARP 요청**
<br>: 송신자는 (출발지(자신) MAC 주소 + 출발지 IP + 목적지 IP)의 정보로 Broadcast Domain에 포함된 PC들에게 `Broadcast`시킵니다.

**2. ARP Reply**
<br>: 요청을 수신한 PC들은 목적지 IP주소를 확인하고 자신이 아니라면 무시, 자신이 맞다면 자신의 MAC 주소를 포함시켜서 응답을 보냅니다. 이때 `Unicast` 방식으로 전송합니다. 

## ARP가 사용되는 경우 4가지**

<img src="https://user-images.githubusercontent.com/53790137/151483305-ce576644-ba37-45fb-8cc8-56f341ebc2d9.png" width="500" height="400">

## ARP Cache Table
통신할 단말끼리 **매번 ARP를 사용하는 것은 매우 비효율적**이기 때문에 스위치나 라우터와 같은 통신 장비는 **IP 주소와 매핑되는 MAC 주소를 메모리에 캐싱**하여 사용합니다.
